<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>StuDeals — Software Architecture</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0f;
    --surface: #111118;
    --surface2: #1a1a24;
    --border: #2a2a3a;
    --accent: #4fffb0;
    --accent2: #7c6aff;
    --accent3: #ff6a6a;
    --accent4: #ffc86a;
    --text: #e8e8f0;
    --muted: #6b6b88;
    --font-head: 'Syne', sans-serif;
    --font-mono: 'JetBrains Mono', monospace;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--font-mono);
    font-size: 13px;
    line-height: 1.7;
    min-height: 100vh;
  }

  /* Grid background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(79,255,176,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(79,255,176,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }

  .container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 60px 32px;
    position: relative;
    z-index: 1;
  }

  /* Header */
  .header {
    border-bottom: 1px solid var(--border);
    padding-bottom: 48px;
    margin-bottom: 64px;
  }

  .tag {
    display: inline-block;
    font-size: 10px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--accent);
    border: 1px solid var(--accent);
    padding: 3px 10px;
    margin-bottom: 20px;
  }

  h1 {
    font-family: var(--font-head);
    font-size: clamp(40px, 6vw, 72px);
    font-weight: 800;
    line-height: 1;
    letter-spacing: -2px;
    margin-bottom: 16px;
  }

  h1 span { color: var(--accent); }

  .subtitle {
    color: var(--muted);
    font-size: 12px;
    letter-spacing: 0.05em;
  }

  /* Section headers */
  .section {
    margin-bottom: 64px;
  }

  .section-title {
    font-family: var(--font-head);
    font-size: 11px;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 24px;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .section-title::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--border);
  }

  .section-heading {
    font-family: var(--font-head);
    font-size: clamp(22px, 3vw, 32px);
    font-weight: 700;
    margin-bottom: 32px;
    letter-spacing: -0.5px;
  }

  /* Stack Grid */
  .stack-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
    margin-bottom: 16px;
  }

  .stack-card {
    background: var(--surface);
    padding: 24px;
    transition: background 0.2s;
  }

  .stack-card:hover { background: var(--surface2); }

  .stack-card-label {
    font-size: 9px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 8px;
  }

  .stack-card-tech {
    font-family: var(--font-head);
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 8px;
  }

  .stack-card-tech.green { color: var(--accent); }
  .stack-card-tech.purple { color: var(--accent2); }
  .stack-card-tech.red { color: var(--accent3); }
  .stack-card-tech.yellow { color: var(--accent4); }

  .stack-card p {
    color: var(--muted);
    font-size: 12px;
    line-height: 1.6;
  }

  /* Why box */
  .why-box {
    background: var(--surface);
    border: 1px solid var(--border);
    border-left: 3px solid var(--accent2);
    padding: 16px 20px;
    margin-top: 8px;
    font-size: 12px;
    color: var(--muted);
  }

  .why-box strong { color: var(--text); }

  /* Architecture diagram */
  .arch-diagram {
    background: var(--surface);
    border: 1px solid var(--border);
    padding: 40px;
    font-size: 12px;
    overflow-x: auto;
  }

  .arch-row {
    display: flex;
    align-items: center;
    gap: 0;
    margin-bottom: 0;
  }

  .arch-layer {
    margin-bottom: 12px;
  }

  .arch-layer-label {
    font-size: 9px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 8px;
  }

  .arch-boxes {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }

  .arch-box {
    border: 1px solid;
    padding: 8px 16px;
    font-size: 11px;
    font-weight: 500;
    white-space: nowrap;
  }

  .arch-box.green { border-color: var(--accent); color: var(--accent); }
  .arch-box.purple { border-color: var(--accent2); color: var(--accent2); }
  .arch-box.red { border-color: var(--accent3); color: var(--accent3); }
  .arch-box.yellow { border-color: var(--accent4); color: var(--accent4); }
  .arch-box.white { border-color: var(--border); color: var(--text); }

  .arch-arrow {
    text-align: center;
    color: var(--muted);
    font-size: 16px;
    margin: 4px 0;
    letter-spacing: 4px;
  }

  /* CRC Cards */
  .crc-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 16px;
  }

  .crc-card {
    border: 1px solid var(--border);
    background: var(--surface);
    overflow: hidden;
  }

  .crc-header {
    padding: 14px 20px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: baseline;
    gap: 12px;
  }

  .crc-name {
    font-family: var(--font-head);
    font-size: 16px;
    font-weight: 700;
  }

  .crc-name.green { color: var(--accent); }
  .crc-name.purple { color: var(--accent2); }
  .crc-name.red { color: var(--accent3); }
  .crc-name.yellow { color: var(--accent4); }
  .crc-name.white { color: var(--text); }

  .crc-type {
    font-size: 9px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--muted);
  }

  .crc-body {
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-bottom: 1px solid var(--border);
  }

  .crc-col {
    padding: 16px 20px;
  }

  .crc-col:first-child {
    border-right: 1px solid var(--border);
  }

  .crc-col-label {
    font-size: 9px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 10px;
  }

  .crc-col ul {
    list-style: none;
  }

  .crc-col li {
    font-size: 11px;
    color: var(--text);
    padding: 2px 0;
    padding-left: 12px;
    position: relative;
  }

  .crc-col li::before {
    content: '→';
    position: absolute;
    left: 0;
    color: var(--muted);
    font-size: 10px;
  }

  .crc-collab {
    padding: 12px 20px;
    background: var(--bg);
  }

  .crc-collab-label {
    font-size: 9px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 6px;
  }

  .collab-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
  }

  .collab-tag {
    font-size: 10px;
    padding: 2px 8px;
    border: 1px solid var(--border);
    color: var(--muted);
  }

  /* DB Schema */
  .schema-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
    gap: 16px;
  }

  .schema-table {
    border: 1px solid var(--border);
    background: var(--surface);
    overflow: hidden;
  }

  .schema-table-name {
    padding: 10px 16px;
    background: var(--surface2);
    border-bottom: 1px solid var(--border);
    font-family: var(--font-head);
    font-size: 13px;
    font-weight: 700;
    color: var(--accent4);
    letter-spacing: 0.05em;
  }

  .schema-field {
    padding: 6px 16px;
    border-bottom: 1px solid rgba(42,42,58,0.5);
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    gap: 8px;
  }

  .field-name {
    font-size: 11px;
    color: var(--text);
  }

  .field-name.pk { color: var(--accent); }
  .field-name.fk { color: var(--accent2); }

  .field-type {
    font-size: 10px;
    color: var(--muted);
  }

  /* API Routes */
  .routes-list {
    border: 1px solid var(--border);
    background: var(--surface);
    overflow: hidden;
  }

  .route-item {
    padding: 12px 20px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: baseline;
    gap: 16px;
  }

  .route-item:last-child { border-bottom: none; }

  .route-method {
    font-size: 10px;
    font-weight: 500;
    padding: 2px 8px;
    min-width: 44px;
    text-align: center;
  }

  .route-method.get { background: rgba(79,255,176,0.1); color: var(--accent); }
  .route-method.post { background: rgba(124,106,255,0.1); color: var(--accent2); }
  .route-method.put { background: rgba(255,200,106,0.1); color: var(--accent4); }
  .route-method.delete { background: rgba(255,106,106,0.1); color: var(--accent3); }

  .route-path {
    font-size: 12px;
    color: var(--text);
    flex: 1;
  }

  .route-desc {
    font-size: 11px;
    color: var(--muted);
    text-align: right;
  }

  /* Flow */
  .flow-list {
    counter-reset: step;
    display: flex;
    flex-direction: column;
    gap: 0;
    border: 1px solid var(--border);
    background: var(--surface);
    overflow: hidden;
  }

  .flow-step {
    counter-increment: step;
    padding: 16px 24px;
    border-bottom: 1px solid var(--border);
    display: flex;
    gap: 16px;
    align-items: flex-start;
    transition: background 0.2s;
  }

  .flow-step:last-child { border-bottom: none; }
  .flow-step:hover { background: var(--surface2); }

  .flow-num {
    font-size: 10px;
    color: var(--muted);
    min-width: 24px;
    padding-top: 2px;
  }

  .flow-num::before { content: counter(step, decimal-leading-zero); }

  .flow-title {
    font-family: var(--font-head);
    font-size: 14px;
    font-weight: 600;
    margin-bottom: 4px;
  }

  .flow-desc {
    font-size: 11px;
    color: var(--muted);
  }

  /* Phase roadmap */
  .phases {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
  }

  .phase {
    background: var(--surface);
    padding: 24px;
  }

  .phase-num {
    font-size: 48px;
    font-family: var(--font-head);
    font-weight: 800;
    color: var(--border);
    line-height: 1;
    margin-bottom: 8px;
  }

  .phase-title {
    font-family: var(--font-head);
    font-size: 16px;
    font-weight: 700;
    margin-bottom: 16px;
  }

  .phase-title.green { color: var(--accent); }
  .phase-title.purple { color: var(--accent2); }
  .phase-title.yellow { color: var(--accent4); }

  .phase ul { list-style: none; }
  .phase li {
    font-size: 11px;
    color: var(--muted);
    padding: 3px 0;
    padding-left: 14px;
    position: relative;
  }
  .phase li::before {
    content: '·';
    position: absolute;
    left: 0;
    color: var(--muted);
  }

  @media (max-width: 700px) {
    .phases { grid-template-columns: 1fr; }
    .crc-body { grid-template-columns: 1fr; }
    .arch-diagram { padding: 20px; }
    .route-desc { display: none; }
  }
</style>
</head>
<body>
<div class="container">

  <!-- Header -->
  <div class="header">
    <div class="tag">Software Architecture v1.0</div>
    <h1>Stude<span>als</span></h1>
    <p class="subtitle">// Student discount map platform — web-first architecture document</p>
  </div>

  <!-- Tech Stack -->
  <div class="section">
    <div class="section-title">01 — Tech Stack</div>
    <div class="section-heading">Languages & Frameworks</div>

    <div class="stack-grid">
      <div class="stack-card">
        <div class="stack-card-label">Frontend</div>
        <div class="stack-card-tech green">Next.js 14 (React)</div>
        <p>TypeScript. App Router. SSR for SEO on place pages. The standard for modern web apps that need both performance and interactivity.</p>
      </div>
      <div class="stack-card">
        <div class="stack-card-label">Styling</div>
        <div class="stack-card-tech purple">Tailwind CSS</div>
        <p>Utility-first, fast to build with, easy to keep consistent. Pairs perfectly with component libraries like shadcn/ui.</p>
      </div>
      <div class="stack-card">
        <div class="stack-card-label">Backend / API</div>
        <div class="stack-card-tech yellow">Next.js API Routes</div>
        <p>No separate backend server needed early on. API lives inside the same Next.js project. Clean, simple, and deploy as one unit.</p>
      </div>
      <div class="stack-card">
        <div class="stack-card-label">Database</div>
        <div class="stack-card-tech green">PostgreSQL via Supabase</div>
        <p>Relational DB — perfect for users, places, reviews, orders. Supabase gives you auth, storage, real-time, and a dashboard for free.</p>
      </div>
      <div class="stack-card">
        <div class="stack-card-label">Auth</div>
        <div class="stack-card-tech purple">Supabase Auth</div>
        <p>Google OAuth built-in. .edu email verification flow. JWT sessions. No need to build auth from scratch.</p>
      </div>
      <div class="stack-card">
        <div class="stack-card-label">Maps</div>
        <div class="stack-card-tech red">Google Maps JS SDK</div>
        <p>Interactive map, place markers, routing, directions, geolocation. Industry standard. Directly connects to Google Maps app for navigation.</p>
      </div>
      <div class="stack-card">
        <div class="stack-card-label">Payments</div>
        <div class="stack-card-tech yellow">Stripe</div>
        <p>Card payments, saved cards, refunds, discount codes. More developer-friendly than PayPal. You can add PayPal on top later via Stripe's PayPal connector.</p>
      </div>
      <div class="stack-card">
        <div class="stack-card-label">Email</div>
        <div class="stack-card-tech green">Resend</div>
        <p>Transactional email for .edu verification, order confirmations, promo campaigns. Simple API, generous free tier.</p>
      </div>
      <div class="stack-card">
        <div class="stack-card-label">Deployment</div>
        <div class="stack-card-tech purple">Vercel</div>
        <p>One-click Next.js deploy. Auto preview URLs on every branch. Free tier is enough to launch. Scale later.</p>
      </div>
      <div class="stack-card">
        <div class="stack-card-label">Language</div>
        <div class="stack-card-tech red">TypeScript</div>
        <p>Typed JavaScript. Catches bugs before you run the code. Non-negotiable on a project this interconnected.</p>
      </div>
      <div class="stack-card">
        <div class="stack-card-label">POS Integration</div>
        <div class="stack-card-tech yellow">Toast API</div>
        <p>Direct order submission to restaurant POS systems. Requires partnership agreement with Toast. Roll out per-restaurant.</p>
      </div>
      <div class="stack-card">
        <div class="stack-card-label">State Management</div>
        <div class="stack-card-tech green">Zustand + React Query</div>
        <p>Zustand for lightweight global state (auth, cart). React Query for server state, caching, and data fetching.</p>
      </div>
    </div>

    <div class="why-box">
      <strong>Why this stack and not something else?</strong> — This is the stack that gets you from zero to a real deployed product fastest, with the least operational overhead. No managing servers. No writing auth from scratch. Everything is JavaScript/TypeScript end-to-end, meaning you only have to know one language deeply. When you're ready to convert to React Native for mobile, ~70% of your logic and all your backend stays the same.
    </div>
  </div>

  <!-- Architecture -->
  <div class="section">
    <div class="section-title">02 — Architecture</div>
    <div class="section-heading">System Architecture</div>

    <div class="arch-diagram">
      <div class="arch-layer">
        <div class="arch-layer-label">Client Layer</div>
        <div class="arch-boxes">
          <div class="arch-box green">Browser / Next.js Frontend</div>
          <div class="arch-box white">React Components</div>
          <div class="arch-box white">Google Maps SDK</div>
          <div class="arch-box white">Stripe.js (client)</div>
        </div>
      </div>
      <div class="arch-arrow">↕ ↕ ↕ HTTPS / REST</div>
      <div class="arch-layer">
        <div class="arch-layer-label">API Layer (Next.js API Routes)</div>
        <div class="arch-boxes">
          <div class="arch-box purple">/api/auth</div>
          <div class="arch-box purple">/api/places</div>
          <div class="arch-box purple">/api/orders</div>
          <div class="arch-box purple">/api/reviews</div>
          <div class="arch-box purple">/api/users</div>
          <div class="arch-box purple">/api/rewards</div>
          <div class="arch-box purple">/api/verify</div>
        </div>
      </div>
      <div class="arch-arrow">↕ ↕ ↕ SDK / REST</div>
      <div class="arch-layer">
        <div class="arch-layer-label">Services Layer</div>
        <div class="arch-boxes">
          <div class="arch-box yellow">Supabase DB (PostgreSQL)</div>
          <div class="arch-box yellow">Supabase Auth</div>
          <div class="arch-box yellow">Supabase Storage</div>
          <div class="arch-box red">Stripe API</div>
          <div class="arch-box red">Resend Email API</div>
          <div class="arch-box green">Toast POS API</div>
          <div class="arch-box green">Google Maps API</div>
        </div>
      </div>
    </div>
  </div>

  <!-- CRC Cards -->
  <div class="section">
    <div class="section-title">03 — CRC Cards</div>
    <div class="section-heading">Class Responsibilities & Collaborators</div>
    <div class="crc-grid">

      <div class="crc-card">
        <div class="crc-header">
          <div class="crc-name green">User</div>
          <div class="crc-type">Model</div>
        </div>
        <div class="crc-body">
          <div class="crc-col">
            <div class="crc-col-label">Responsibilities</div>
            <ul>
              <li>Store profile & credentials</li>
              <li>Track .edu verification status</li>
              <li>Hold personal email</li>
              <li>Track review count & rewards balance</li>
              <li>Manage OAuth session (Google)</li>
            </ul>
          </div>
          <div class="crc-col">
            <div class="crc-col-label">Data Fields</div>
            <ul>
              <li>id, email, personal_email</li>
              <li>edu_verified: boolean</li>
              <li>google_id</li>
              <li>review_count</li>
              <li>rewards_balance</li>
              <li>created_at</li>
            </ul>
          </div>
        </div>
        <div class="crc-collab">
          <div class="crc-collab-label">Collaborates With</div>
          <div class="collab-tags">
            <span class="collab-tag">Review</span>
            <span class="collab-tag">Order</span>
            <span class="collab-tag">Reward</span>
            <span class="collab-tag">AuthService</span>
          </div>
        </div>
      </div>

      <div class="crc-card">
        <div class="crc-header">
          <div class="crc-name purple">Place</div>
          <div class="crc-type">Model</div>
        </div>
        <div class="crc-body">
          <div class="crc-col">
            <div class="crc-col-label">Responsibilities</div>
            <ul>
              <li>Store restaurant/cafe data</li>
              <li>Hold discount info & conditions</li>
              <li>Store location coordinates</li>
              <li>Track average rating</li>
              <li>Define ordering availability</li>
              <li>Store POS integration type</li>
            </ul>
          </div>
          <div class="crc-col">
            <div class="crc-col-label">Data Fields</div>
            <ul>
              <li>id, name, address</li>
              <li>lat, lng</li>
              <li>category (drinks, food…)</li>
              <li>discount_description</li>
              <li>discount_percent</li>
              <li>pos_type (toast/none)</li>
              <li>avg_rating</li>
              <li>hours (json)</li>
            </ul>
          </div>
        </div>
        <div class="crc-collab">
          <div class="crc-collab-label">Collaborates With</div>
          <div class="collab-tags">
            <span class="collab-tag">Review</span>
            <span class="collab-tag">Order</span>
            <span class="collab-tag">MenuItem</span>
            <span class="collab-tag">MapService</span>
          </div>
        </div>
      </div>

      <div class="crc-card">
        <div class="crc-header">
          <div class="crc-name yellow">Order</div>
          <div class="crc-type">Model</div>
        </div>
        <div class="crc-body">
          <div class="crc-col">
            <div class="crc-col-label">Responsibilities</div>
            <ul>
              <li>Hold cart items & quantities</li>
              <li>Apply student discount</li>
              <li>Track payment status</li>
              <li>Submit to POS via Toast API</li>
              <li>Issue order confirmation</li>
            </ul>
          </div>
          <div class="crc-col">
            <div class="crc-col-label">Data Fields</div>
            <ul>
              <li>id, user_id, place_id</li>
              <li>items (json)</li>
              <li>subtotal, discount, total</li>
              <li>payment_intent_id</li>
              <li>status (pending/paid/sent)</li>
              <li>pos_order_id</li>
              <li>created_at</li>
            </ul>
          </div>
        </div>
        <div class="crc-collab">
          <div class="crc-collab-label">Collaborates With</div>
          <div class="collab-tags">
            <span class="collab-tag">User</span>
            <span class="collab-tag">Place</span>
            <span class="collab-tag">StripeService</span>
            <span class="collab-tag">ToastService</span>
            <span class="collab-tag">MenuItem</span>
          </div>
        </div>
      </div>

      <div class="crc-card">
        <div class="crc-header">
          <div class="crc-name red">Review</div>
          <div class="crc-type">Model</div>
        </div>
        <div class="crc-body">
          <div class="crc-col">
            <div class="crc-col-label">Responsibilities</div>
            <ul>
              <li>Store rating + text body</li>
              <li>Link user to place</li>
              <li>Trigger reward check on create</li>
              <li>Update place avg_rating</li>
            </ul>
          </div>
          <div class="crc-col">
            <div class="crc-col-label">Data Fields</div>
            <ul>
              <li>id, user_id, place_id</li>
              <li>rating (1–5)</li>
              <li>body text</li>
              <li>verified_visit: boolean</li>
              <li>created_at</li>
            </ul>
          </div>
        </div>
        <div class="crc-collab">
          <div class="crc-collab-label">Collaborates With</div>
          <div class="collab-tags">
            <span class="collab-tag">User</span>
            <span class="collab-tag">Place</span>
            <span class="collab-tag">RewardService</span>
          </div>
        </div>
      </div>

      <div class="crc-card">
        <div class="crc-header">
          <div class="crc-name green">MenuItem</div>
          <div class="crc-type">Model</div>
        </div>
        <div class="crc-body">
          <div class="crc-col">
            <div class="crc-col-label">Responsibilities</div>
            <ul>
              <li>Store item name, price, desc</li>
              <li>Flag items with student price</li>
              <li>Belong to a Place</li>
              <li>Be added to Order cart</li>
            </ul>
          </div>
          <div class="crc-col">
            <div class="crc-col-label">Data Fields</div>
            <ul>
              <li>id, place_id</li>
              <li>name, description</li>
              <li>price, student_price</li>
              <li>category (drinks/food)</li>
              <li>available: boolean</li>
              <li>image_url</li>
            </ul>
          </div>
        </div>
        <div class="crc-collab">
          <div class="crc-collab-label">Collaborates With</div>
          <div class="collab-tags">
            <span class="collab-tag">Place</span>
            <span class="collab-tag">Order</span>
          </div>
        </div>
      </div>

      <div class="crc-card">
        <div class="crc-header">
          <div class="crc-name purple">Reward</div>
          <div class="crc-type">Model</div>
        </div>
        <div class="crc-body">
          <div class="crc-col">
            <div class="crc-col-label">Responsibilities</div>
            <ul>
              <li>Track reward thresholds</li>
              <li>Issue $5 discount codes</li>
              <li>Log reward redemptions</li>
              <li>Notify user when earned</li>
            </ul>
          </div>
          <div class="crc-col">
            <div class="crc-col-label">Data Fields</div>
            <ul>
              <li>id, user_id</li>
              <li>type (review_milestone)</li>
              <li>value ($5)</li>
              <li>code (stripe coupon id)</li>
              <li>redeemed: boolean</li>
              <li>earned_at, redeemed_at</li>
            </ul>
          </div>
        </div>
        <div class="crc-collab">
          <div class="crc-collab-label">Collaborates With</div>
          <div class="collab-tags">
            <span class="collab-tag">User</span>
            <span class="collab-tag">Review</span>
            <span class="collab-tag">StripeService</span>
            <span class="collab-tag">EmailService</span>
          </div>
        </div>
      </div>

      <div class="crc-card">
        <div class="crc-header">
          <div class="crc-name yellow">AuthService</div>
          <div class="crc-type">Service</div>
        </div>
        <div class="crc-body">
          <div class="crc-col">
            <div class="crc-col-label">Responsibilities</div>
            <ul>
              <li>Handle Google OAuth login</li>
              <li>Send .edu verification email</li>
              <li>Confirm .edu token</li>
              <li>Issue JWT session</li>
              <li>Guard protected routes</li>
            </ul>
          </div>
          <div class="crc-col">
            <div class="crc-col-label">Methods</div>
            <ul>
              <li>signInWithGoogle()</li>
              <li>sendEduVerification(email)</li>
              <li>confirmEduToken(token)</li>
              <li>getSession()</li>
              <li>signOut()</li>
            </ul>
          </div>
        </div>
        <div class="crc-collab">
          <div class="crc-collab-label">Collaborates With</div>
          <div class="collab-tags">
            <span class="collab-tag">User</span>
            <span class="collab-tag">Supabase Auth</span>
            <span class="collab-tag">EmailService</span>
          </div>
        </div>
      </div>

      <div class="crc-card">
        <div class="crc-header">
          <div class="crc-name red">MapService</div>
          <div class="crc-type">Service</div>
        </div>
        <div class="crc-body">
          <div class="crc-col">
            <div class="crc-col-label">Responsibilities</div>
            <ul>
              <li>Render Google Map with markers</li>
              <li>Get user geolocation</li>
              <li>Filter visible places by bounds</li>
              <li>Open directions in Google Maps</li>
              <li>Handle category filters</li>
            </ul>
          </div>
          <div class="crc-col">
            <div class="crc-col-label">Methods</div>
            <ul>
              <li>renderMap(places[])</li>
              <li>getUserLocation()</li>
              <li>filterByCategory(cat)</li>
              <li>openDirections(place)</li>
              <li>onMarkerClick(place)</li>
            </ul>
          </div>
        </div>
        <div class="crc-collab">
          <div class="crc-collab-label">Collaborates With</div>
          <div class="collab-tags">
            <span class="collab-tag">Place</span>
            <span class="collab-tag">Google Maps API</span>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- DB Schema -->
  <div class="section">
    <div class="section-title">04 — Database</div>
    <div class="section-heading">PostgreSQL Schema (Supabase)</div>
    <div class="schema-grid">

      <div class="schema-table">
        <div class="schema-table-name">users</div>
        <div class="schema-field"><span class="field-name pk">id</span><span class="field-type">uuid PK</span></div>
        <div class="schema-field"><span class="field-name">edu_email</span><span class="field-type">text unique</span></div>
        <div class="schema-field"><span class="field-name">personal_email</span><span class="field-type">text unique</span></div>
        <div class="schema-field"><span class="field-name">google_id</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">display_name</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">edu_verified</span><span class="field-type">boolean</span></div>
        <div class="schema-field"><span class="field-name">review_count</span><span class="field-type">integer</span></div>
        <div class="schema-field"><span class="field-name">rewards_balance</span><span class="field-type">numeric</span></div>
        <div class="schema-field"><span class="field-name">created_at</span><span class="field-type">timestamptz</span></div>
      </div>

      <div class="schema-table">
        <div class="schema-table-name">places</div>
        <div class="schema-field"><span class="field-name pk">id</span><span class="field-type">uuid PK</span></div>
        <div class="schema-field"><span class="field-name">name</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">address</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">lat</span><span class="field-type">numeric</span></div>
        <div class="schema-field"><span class="field-name">lng</span><span class="field-type">numeric</span></div>
        <div class="schema-field"><span class="field-name">category</span><span class="field-type">text[]</span></div>
        <div class="schema-field"><span class="field-name">discount_description</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">discount_percent</span><span class="field-type">numeric</span></div>
        <div class="schema-field"><span class="field-name">pos_type</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">avg_rating</span><span class="field-type">numeric</span></div>
        <div class="schema-field"><span class="field-name">hours</span><span class="field-type">jsonb</span></div>
        <div class="schema-field"><span class="field-name">active</span><span class="field-type">boolean</span></div>
      </div>

      <div class="schema-table">
        <div class="schema-table-name">menu_items</div>
        <div class="schema-field"><span class="field-name pk">id</span><span class="field-type">uuid PK</span></div>
        <div class="schema-field"><span class="field-name fk">place_id</span><span class="field-type">uuid FK</span></div>
        <div class="schema-field"><span class="field-name">name</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">description</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">price</span><span class="field-type">numeric</span></div>
        <div class="schema-field"><span class="field-name">student_price</span><span class="field-type">numeric</span></div>
        <div class="schema-field"><span class="field-name">category</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">image_url</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">available</span><span class="field-type">boolean</span></div>
      </div>

      <div class="schema-table">
        <div class="schema-table-name">orders</div>
        <div class="schema-field"><span class="field-name pk">id</span><span class="field-type">uuid PK</span></div>
        <div class="schema-field"><span class="field-name fk">user_id</span><span class="field-type">uuid FK</span></div>
        <div class="schema-field"><span class="field-name fk">place_id</span><span class="field-type">uuid FK</span></div>
        <div class="schema-field"><span class="field-name">items</span><span class="field-type">jsonb</span></div>
        <div class="schema-field"><span class="field-name">subtotal</span><span class="field-type">numeric</span></div>
        <div class="schema-field"><span class="field-name">discount</span><span class="field-type">numeric</span></div>
        <div class="schema-field"><span class="field-name">total</span><span class="field-type">numeric</span></div>
        <div class="schema-field"><span class="field-name">payment_intent_id</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">pos_order_id</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">status</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">created_at</span><span class="field-type">timestamptz</span></div>
      </div>

      <div class="schema-table">
        <div class="schema-table-name">reviews</div>
        <div class="schema-field"><span class="field-name pk">id</span><span class="field-type">uuid PK</span></div>
        <div class="schema-field"><span class="field-name fk">user_id</span><span class="field-type">uuid FK</span></div>
        <div class="schema-field"><span class="field-name fk">place_id</span><span class="field-type">uuid FK</span></div>
        <div class="schema-field"><span class="field-name">rating</span><span class="field-type">int (1–5)</span></div>
        <div class="schema-field"><span class="field-name">body</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">verified_visit</span><span class="field-type">boolean</span></div>
        <div class="schema-field"><span class="field-name">created_at</span><span class="field-type">timestamptz</span></div>
      </div>

      <div class="schema-table">
        <div class="schema-table-name">rewards</div>
        <div class="schema-field"><span class="field-name pk">id</span><span class="field-type">uuid PK</span></div>
        <div class="schema-field"><span class="field-name fk">user_id</span><span class="field-type">uuid FK</span></div>
        <div class="schema-field"><span class="field-name">type</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">value</span><span class="field-type">numeric</span></div>
        <div class="schema-field"><span class="field-name">stripe_coupon_id</span><span class="field-type">text</span></div>
        <div class="schema-field"><span class="field-name">redeemed</span><span class="field-type">boolean</span></div>
        <div class="schema-field"><span class="field-name">earned_at</span><span class="field-type">timestamptz</span></div>
        <div class="schema-field"><span class="field-name">redeemed_at</span><span class="field-type">timestamptz</span></div>
      </div>

    </div>
    <div class="why-box" style="margin-top:16px">
      <strong>Key:</strong> <span style="color:var(--accent)">green = primary key</span> &nbsp;·&nbsp; <span style="color:var(--accent2)">purple = foreign key</span>
    </div>
  </div>

  <!-- API Routes -->
  <div class="section">
    <div class="section-title">05 — API</div>
    <div class="section-heading">Core API Endpoints</div>
    <div class="routes-list">
      <div class="route-item"><span class="route-method post">POST</span><span class="route-path">/api/auth/edu-verify</span><span class="route-desc">Send .edu verification email</span></div>
      <div class="route-item"><span class="route-method post">POST</span><span class="route-path">/api/auth/edu-confirm</span><span class="route-desc">Confirm token, mark verified</span></div>
      <div class="route-item"><span class="route-method get">GET</span><span class="route-path">/api/places</span><span class="route-desc">List all places (with filters)</span></div>
      <div class="route-item"><span class="route-method get">GET</span><span class="route-path">/api/places/:id</span><span class="route-desc">Single place + menu items</span></div>
      <div class="route-item"><span class="route-method get">GET</span><span class="route-path">/api/places/nearby</span><span class="route-desc">Places within map bounds</span></div>
      <div class="route-item"><span class="route-method get">GET</span><span class="route-path">/api/places/:id/menu</span><span class="route-desc">All menu items for a place</span></div>
      <div class="route-item"><span class="route-method post">POST</span><span class="route-path">/api/orders</span><span class="route-desc">Create order + Stripe payment intent</span></div>
      <div class="route-item"><span class="route-method post">POST</span><span class="route-path">/api/orders/:id/confirm</span><span class="route-desc">Payment confirmed → submit to Toast</span></div>
      <div class="route-item"><span class="route-method get">GET</span><span class="route-path">/api/orders/history</span><span class="route-desc">User order history</span></div>
      <div class="route-item"><span class="route-method post">POST</span><span class="route-path">/api/reviews</span><span class="route-desc">Submit review → trigger reward check</span></div>
      <div class="route-item"><span class="route-method get">GET</span><span class="route-path">/api/reviews/:placeId</span><span class="route-desc">Reviews for a place</span></div>
      <div class="route-item"><span class="route-method get">GET</span><span class="route-path">/api/users/me</span><span class="route-desc">Current user profile + rewards</span></div>
      <div class="route-item"><span class="route-method put">PUT</span><span class="route-path">/api/users/me</span><span class="route-desc">Update profile</span></div>
      <div class="route-item"><span class="route-method get">GET</span><span class="route-path">/api/rewards</span><span class="route-desc">User reward balance + history</span></div>
      <div class="route-item"><span class="route-method post">POST</span><span class="route-path">/api/webhooks/stripe</span><span class="route-desc">Stripe payment webhooks</span></div>
    </div>
  </div>

  <!-- Key Flows -->
  <div class="section">
    <div class="section-title">06 — User Flows</div>
    <div class="section-heading">Critical User Journeys</div>

    <p style="color:var(--muted); font-size:12px; margin-bottom:16px">// Onboarding Flow</p>
    <div class="flow-list" style="margin-bottom:32px">
      <div class="flow-step">
        <div class="flow-num"></div>
        <div><div class="flow-title">Land on homepage</div><div class="flow-desc">See map preview of Chicago + CTA to sign up</div></div>
      </div>
      <div class="flow-step">
        <div class="flow-num"></div>
        <div><div class="flow-title">Sign in with Google</div><div class="flow-desc">OAuth popup → Supabase creates user record</div></div>
      </div>
      <div class="flow-step">
        <div class="flow-num"></div>
        <div><div class="flow-title">Enter .edu email</div><div class="flow-desc">Validation: must end in .edu. Resend sends verification link.</div></div>
      </div>
      <div class="flow-step">
        <div class="flow-num"></div>
        <div><div class="flow-title">Click email link</div><div class="flow-desc">Token confirmed → edu_verified = true on user record</div></div>
      </div>
      <div class="flow-step">
        <div class="flow-num"></div>
        <div><div class="flow-title">Enter personal email</div><div class="flow-desc">For promotions and updates. Saved separately.</div></div>
      </div>
      <div class="flow-step">
        <div class="flow-num"></div>
        <div><div class="flow-title">Full map access unlocked</div><div class="flow-desc">Redirected to main map view with all discount locations visible</div></div>
      </div>
    </div>

    <p style="color:var(--muted); font-size:12px; margin-bottom:16px">// Order Flow (Toast-connected restaurant)</p>
    <div class="flow-list">
      <div class="flow-step">
        <div class="flow-num"></div>
        <div><div class="flow-title">Tap marker on map</div><div class="flow-desc">Place card slides up: discount info, rating, "Order Now" button</div></div>
      </div>
      <div class="flow-step">
        <div class="flow-num"></div>
        <div><div class="flow-title">Browse menu</div><div class="flow-desc">Items show regular price + student price side by side</div></div>
      </div>
      <div class="flow-step">
        <div class="flow-num"></div>
        <div><div class="flow-title">Add to cart</div><div class="flow-desc">Cart state managed in Zustand. Student discount auto-applied.</div></div>
      </div>
      <div class="flow-step">
        <div class="flow-num"></div>
        <div><div class="flow-title">Checkout with Stripe</div><div class="flow-desc">POST /api/orders creates order + Stripe PaymentIntent. Card or saved card.</div></div>
      </div>
      <div class="flow-step">
        <div class="flow-num"></div>
        <div><div class="flow-title">Payment confirmed</div><div class="flow-desc">Stripe webhook fires → POST /api/orders/:id/confirm → order submitted to Toast POS</div></div>
      </div>
      <div class="flow-step">
        <div class="flow-num"></div>
        <div><div class="flow-title">Confirmation + directions</div><div class="flow-desc">Order # shown. "Get Directions" opens Google Maps with fastest route.</div></div>
      </div>
    </div>
  </div>

  <!-- Build Phases -->
  <div class="section">
    <div class="section-title">07 — Build Roadmap</div>
    <div class="section-heading">Development Phases</div>
    <div class="phases">
      <div class="phase">
        <div class="phase-num">01</div>
        <div class="phase-title green">Foundation</div>
        <ul>
          <li>Next.js + Supabase setup</li>
          <li>Google OAuth login</li>
          <li>.edu verification flow</li>
          <li>Database schema migration</li>
          <li>Map with hardcoded places</li>
          <li>Category filter (drinks)</li>
          <li>Place detail cards</li>
          <li>Deploy to Vercel</li>
        </ul>
      </div>
      <div class="phase">
        <div class="phase-num">02</div>
        <div class="phase-title purple">Commerce</div>
        <ul>
          <li>Menu item data model</li>
          <li>Cart with Zustand</li>
          <li>Stripe integration</li>
          <li>Order creation API</li>
          <li>Toast API partnership</li>
          <li>Order → POS submission</li>
          <li>Order history page</li>
          <li>Review system + rewards</li>
        </ul>
      </div>
      <div class="phase">
        <div class="phase-num">03</div>
        <div class="phase-title yellow">Intelligence</div>
        <ul>
          <li>Behavior tracking events</li>
          <li>Personalized suggestions</li>
          <li>Midterm/seasonal promos</li>
          <li>Admin dashboard</li>
          <li>Business onboarding flow</li>
          <li>Analytics dashboard</li>
          <li>React Native migration</li>
          <li>App Store submission</li>
        </ul>
      </div>
    </div>
  </div>

</div>
</body>
</html>